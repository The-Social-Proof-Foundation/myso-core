[build]
builder = "dockerfile"
dockerfilePath = "crates/myso-indexer-alt-graphql/Dockerfile"
buildCommand = "cargo build --release --bin myso-indexer-alt-graphql"

[deploy]
startCommand = "myso-indexer-alt-graphql rpc --database-url $DATABASE_URL --fullnode-rpc-url $RPC_URL --rpc-listen-address 0.0.0.0:$PORT"
healthcheckPath = "/health"
healthcheckTimeout = 300
restartPolicyType = "on_failure"

[deploy.envVars]
PORT = { sync = false }
DATABASE_URL = { sync = false }
RPC_URL = { sync = false }

# Explicitly tell Railway this is a Rust project
[build.env]
NIXPACKS_LANGUAGE = "rust"
NIXPACKS_BUILD_CMD = "cargo build --release --bin myso-indexer-alt-graphql"

[variables]
# Logging configuration  
RUST_LOG = "info,myso_graphql_rpc=debug"
RUST_BACKTRACE = "1" 