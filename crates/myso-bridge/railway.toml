[build]
builder = "dockerfile"
dockerfilePath = "crates/myso-bridge/Dockerfile"

[deploy]
startCommand = "sh -c 'echo \"$BRIDGE_AUTHORITY_KEY\" > /tmp/bridge_key && cargo run --release --bin myso-bridge -- --config-path /app/bridge-config.yaml'"
# healthcheckPath = "/metrics"
# healthcheckTimeout = 300

[variables]
BRIDGE_AUTHORITY_KEY = ""

# Optional: Logging configuration  
RUST_LOG = "info,myso_bridge=debug"

# Database Configuration (only needed if using bridge client features)
DATABASE_URL = "${{Postgres.DATABASE_URL}}"

# Required: Bridge configuration environment variables
# These are substituted into bridge-config.yaml at runtime
# ETH_RPC_URL must be set (contains API keys - do not commit to Git)
ETH_RPC_URL = ""
# ETH_BRIDGE_PROXY_ADDRESS must be set
ETH_BRIDGE_PROXY_ADDRESS = "0x42c69700027E1C7F9Af981FB5B39BAb824560225"

# Optional: Override other config values
# MYS_RPC_URL = "http://fullnode.testnet.mysocial.network:8082"

# Bridge Node Configuration
BRIDGE_NODE_PORT = "8080"
BRIDGE_METRICS_PORT = "9090"

# Contract Addresses (Base Sepolia)
BRIDGE_COMMITTEE_ADDRESS = "0xd2c2F7E07D66Defe53464F2e211F24e3EDFec58a"
BRIDGE_CONFIG_ADDRESS = "0xD938CC56Cda0ba337ad7c1CDF4F529CA85f735bf"
BRIDGE_LIMITER_ADDRESS = "0x5412A5c64Da3B3E8AA4a5F84314a5356a4ea50b1"
BRIDGE_VAULT_ADDRESS = "0xB480E13AFE93c9cb68f03Abd46701509eAEEd3c2"

# Bridge Authority Configuration
BRIDGE_COMMITTEE_MEMBER = "true"

# Network Configuration
SOURCE_CHAIN_ID = "12"  # Base Sepolia
TARGET_CHAIN_ID = "2"      # MySo Network

# Monitoring and Logging
LOG_LEVEL = "info"
METRICS_ENABLED = "true"
PROMETHEUS_PORT = "9090"

# Performance Settings
SYNC_BATCH_SIZE = "100"
SYNC_INTERVAL_MS = "5000"
MAX_CONCURRENT_REQUESTS = "10"

# Security Settings
ENABLE_CORS = "true"
TRUSTED_PROXY_COUNT = "1"

# Feature Flags
ENABLE_EMERGENCY_PAUSE = "true"
ENABLE_RATE_LIMITING = "true"
ENABLE_TRANSFER_LIMITS = "true" 